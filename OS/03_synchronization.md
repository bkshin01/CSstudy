# ✔️ 동기화(Synchronization)

## Race condition에 대해서 설명해 보세요.
둘 이상의 스레드가 동일한 자원에 접근하여 조작하고, 그 실행 결과가 접근이 발생한 순서에 따라 달라지는 것을 말합니다.

<br>

[추가 키워드]
- 동기화 문제: 여러 스레드가 동일한 자원에 동시에 접근하여 엉뚱한 값을 읽거나 수정하는 문제.

<br>

## 임계 구역이 무엇인지 설명해 보세요.
임계 구역은 어떤 코드의 영역에서 다수의 프로세스가 서로 데이터를 공유하는 부분을 말합니다.<br>
한 번에 여러 스레드가 임계구역에 접근하여 데이터를 변경하면 동기화 문제가 발생할 수 있습니다.<br>
따라서 임계구역 내의 코드들은 원자적으로 실행되어야 합니다.

<br>

## 임계 구역 문제를 해결하기 위한 조건을 말해 보세요.
이를 해결하기 위해서는 다음 세 가지 요구조건을 만족시켜야 합니다.
1. `상호 배제` : 어떤 프로세스가 임계 구역에 있다면 다른 스레드는 임계 구역으로 진입할 수 없습니다.
2. `진행` : 임계 구역에 스레드가 없고, 다수의 스레드가 임계 구역 진입을 위해 대기중이라면 하나의 스레드를 적절히 임계 구역이 진입시켜야 합니다.
3. `한정 대기` : 한 번 임계구역에 진입했던 스레드는 다음 실행에 대해 제한을 받아야 합니다.

<br>

## 임계 구역 문제를 해결하기 위한 하드웨어적인 방법을 말해 보세요.
`Test & Set`과 `Compare-and-Swap`이 있습니다.<br>
두 방법 모두 임계구역 진입을 위한 원자적인 연산을 보장하며 이를 통해 상호 배제와 진행 조건을 만족시킵니다.<br>
하지만 한 번 임계구역에 진입했던 스레드가 다시 임계구역으로 재진입 하는 것을 제한하지 않기 때문에 한정 대기 요구조건을 만족시키지는 못합니다.

<br>

## Mutex에 대해 설명해 보세요.
동기화 방법 중 하나로 공유 자원에 접근할 수 있는 스레드의 수를 1개로 제한하여 경쟁 상황을 방지하고 동기화되도록 관리합니다.<br>
임계 구역을 보호하고 경쟁 상황을 방지하기 위해 `mutex lock`을 사용합니다. 이는 acquire, release로 획득, 반환할 수 있습니다.<br>
즉, 스레드는 임계 구역에 진입하기 전에 반드시 lock을 획득해야 하고, 임계 구역에서 빠져나올 때 lock을 반환해야 합니다. 

<br>

[추가 키워드]
- busy waiting: 공유 자원을 기다리며 아무 작업도 하지 않고 접근 가능한지 무한으로 검사만 하고 있는 상황.
  

<br>

## Semaphore가 무엇인지 말해 보세요.
세마포어는 wait, signal의 원자적인 명령을 사용해서 공유 자원 문제를 해결합니다.<br>
세마포어는 정수형 변수를 두어 동시에 접근 가능한 스레드의 개수를 저장합니다.
이 변수가 0보다 크면 임계 구역에 들어갈 수 있고, 진입하면 변수의 값을 1 감소시킵니다.
변수의 값이 0이 되면 다른 스레드는 대기해야 하고, 임계 구역에서의 작업이 끝나면 빠져나오면서 변수의 값을 1 증가시킵니다.

<br>

[추가 키워드]
- spin lock: 스레드는 임계 구역에 진입할 때까지 의미 없는 접근을 계속 시도하는 방식으로 구현된 lock으로 busy waiting의 한 종류.

<br>

## Mutex와 semaphore 기법을 비교해서 설명해 주세요.
두 방법 모두 멀티 프로세스, 멀티 스레드 환경에서 동기화 문제를 해결하기 위한 방법입니다.<br>
뮤텍스는 공유 자원에 접근할 수 있는 스레드의 수를 1개로 제한하여 경쟁 상황을 방지하는 반면
세마포어는 2개 이상의 스레드가 접근할 수 있다는 차이가 있습니다.

<br>

## 교착 상태에 대해서 설명해 주세요.
둘 이상의 스레드가 각기 다른 스레드가 점유하고 있는 자원을 서로 기다릴 때, 무한 대기에 빠지는 상황을 말합니다.

<br>

## 교착 상태의 조건에 대해 말해 보세요.
다음의 4가지 조건이 동시에 성립할 때 데드락이 발생할 수 있습니다.
1. 상호 배제 (mutual exclusion)
   - 동시에 한 스레드만 자원을 점유할 수 있는 상황
   - 다른 스레드가 자원을 사용하려면 자원이 방출될 때까지 기다려야 하는 상황
2. 점유 대기 (hold-and-wait)
   - 스레드가 자원을 보유한 상태에서 다른 스레드가 보유한 자원을 추가로 기다리는 상황
3. 비선점 (no preemption)
   - 다른 스레드가 이미 사용중인 자원을 강제로 선점할 수 없는 상황
   - 자원을 점유하고 있는 스레드에 의해서만 자원이 방출될 수 있다
4. 순환 대기 (circular wait)
   - 대기 중인 스레드들이 순환 형태로 자원을 대기하고 있는 상황

<br>

## 교착 상태의 해결 방법에 대해 말해 보세요.
다음의 4가지 방법이 있습니다.
| 기법 | 설명 | 비고 |
| --- | --- | --- |
| 무시 | deadlock 발생 확률이 낮은 시스템에서 아무런 조치를 취하지 않고 deadlock을 무시하는 방법 | - 무시 기법은 **시스템 성능 저하가 없다**는 큰 장점을 보유 - 현대 시스템에서는 deadlock이 **잘 발생하지 않고, 해결 비용이 크기 때문에** 무시 방법을 많이 사용함 |
| 예방 | 교착 상태의 4가지 발생 조건 중 하나가 성립하지 않게 하는 방법 | - 순환 대기 조건이 성립하지 않도록 하는 것이 현실적으로 가능한 예방 기법 - 자원 사용의 **효율성이 떨어지고 비용이 큼** |
| 회피 | thread가 앞으로 자원을 어떻게 요청할지에 대한 정보를 통해 순환 대기 상태가 발생하지 않도록 자원을 할당하는 방법 | - 자원 할당 그래프 알고리즘, 은행원 알고리즘 등을 사용하여 자원을 할당하여 deadlock을 회피 |
| 탐지-회복 | 시스템 검사를 통해 deadlock 발생을 탐지하고 이를 회복하는 방법 | - 자원 사용의 **효율성이 떨어지고 비용이 큼** |

<br>

## 자원 할당 그래프 알고리즘에 대해 설명해 보세요.
각 스레드와 공유 자원을 그래프의 정점으로 만들고, 
한 스레드가 다른 스레드에게 자원을 요청할 때 두 정점 사이에 요청 간선을 만듭니다.
한 스레드가 자원을 획득하면 할당선을 만들게 됩니다.<br>
이때 각 정점들 사이에 사이클이 발생하면 교착 상태가 발생했다고 판단합니다.

<br>

## 은행원 알고리즘에 대해 설명해 보세요.
안전 상태와 불안전 상태 개념을 사용합니다.
안전 상태는 스레드가 요구한 만큼의 자원 할당이 가능한 상태를 말하고, 이 때는 데드락이 발생하지 않습니다.
불안전 상태는 요구받은 만큼의 자원을 가지고 있지 않은 상황을 말합니다.<br>
운영체제는 자원 할당 요청을 받았을 때, 해당 자원을 할당한 이후에 안전 상태가 유지되는지 미리 검사하고, 유지되는 자원 요구만을 수락합니다.
